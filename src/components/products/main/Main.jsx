import FilterBar from "./filterBar";
import SideBar from "./SideBar";
import { ArrayProducts } from "../../../utils/utils";
import Card from "./Card";
import { useState } from "react";

const Main = () => {
  const [query, setQuery] = useState("");

  const [filter, setFilter] = useState({
    categoryInput: "",
    yearsInput: "",
    language: "",
    price: "",
    publishH: "",
    coverType: "",
    ratingCheck: "",
  });

  const array = ArrayProducts.filter((item) => {
    const queryCheck = item.title.toLowerCase().includes(query.toLowerCase());

    const lang =
      filter.language === "" ? true : item.lang.includes(filter.language);

    const year =
      !filter.yearsInput || filter.yearsInput === "none"
        ? true
        : item.publishDate.includes(filter.yearsInput);

    const publishH =
      filter.publishH === "" ? true : item.publisher.includes(filter.publishH);

    const cover =
      filter.coverType === "" ? true : item.cover.includes(filter.coverType);
    const star =
      filter.ratingCheck === "" ? true : item.star > filter.ratingCheck;

    const itemPrice = parseFloat(item.saleP.replace("$", ""));
    const [minPrice, maxPrice] = filter.price || [0, 120];
    const matchesPrice = itemPrice >= minPrice && itemPrice <= maxPrice;

    return (
      queryCheck && lang && year && publishH && cover && star && matchesPrice
    );
  });

  return (
    <div className="max-w-[1440px] mx-auto px-4 py-10">
      <div className="">
        <FilterBar
          queryFunc={setQuery}
          setFilter={setFilter}
          filterObj={filter}
          arrayNum={array.length}
        />
      </div>
      <div className="bg-grayBg mt-10 flex  gap-2">
        <div className="hidden md:block">
          <SideBar setFilter={setFilter} filter={filter} />
        </div>
        <div className="md:w-[80vw] w-full">
          <div className="flex justify-around gap-2 md:gap-3 flex-wrap ">
            {array.length > 0 ? (
              array.map((item, index) => (
                <Card
                  key={index}
                  image={item.image}
                  author={item.author}
                  title={item.title}
                  comts={item.comts}
                  star={item.star}
                  people={item.people}
                  price={item.price}
                  saleP={item.saleP}
                  type={item.type}
                  publishDate={item.publishDate}
                  lang={item.lang}
                  pages={item.pages}
                  readTime={item.readTime}
                  cover={item.cover}
                  publisher={item.publisher}
                />
              ))
            ) : (
              <p className="text-red text-4xl  w-full text-center font-bold pt-[20%]">
                No books found
              </p>
            )}
          </div>
          <svg
            height={40}
            className="mt-10 hidden md:block mx-auto w-max"
            viewBox="0 0 524 40"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <rect
              width={92}
              height={40}
              rx={20}
              fill="black"
              fillOpacity={0.38}
            />
            <path
              d="M26.5 25L21.5 20L26.5 15"
              stroke="white"
              strokeWidth={1.5}
              strokeLinecap="round"
              strokeLinejoin="round"
            />
            <path
              d="M46.9345 20.78H43.7005V19.884H47.0885C47.8538 19.884 48.4185 19.716 48.7825 19.38C49.1465 19.0347 49.3285 18.4747 49.3285 17.7C49.3285 16.9347 49.1465 16.384 48.7825 16.048C48.4185 15.7027 47.8538 15.53 47.0885 15.53H43.7005V14.62H46.9345C47.5878 14.62 48.1712 14.7413 48.6845 14.984C49.1978 15.2267 49.5992 15.5767 49.8885 16.034C50.1872 16.4913 50.3365 17.0467 50.3365 17.7C50.3365 18.3533 50.1872 18.9133 49.8885 19.38C49.5992 19.8373 49.1978 20.1873 48.6845 20.43C48.1712 20.6633 47.5878 20.78 46.9345 20.78ZM44.2745 24H43.2665V14.62H44.2745V24ZM52.485 24H51.477V14.62H55.299C55.943 14.62 56.5076 14.7273 56.993 14.942C57.4876 15.1473 57.8703 15.4553 58.141 15.866C58.421 16.2767 58.561 16.7713 58.561 17.35C58.561 17.8727 58.4443 18.33 58.211 18.722C57.9776 19.1047 57.651 19.4033 57.231 19.618C56.8203 19.8233 56.3303 19.9353 55.761 19.954V20.024C56.0596 20.1173 56.3116 20.262 56.517 20.458C56.7223 20.654 56.909 20.8967 57.077 21.186L58.673 24H57.511L55.999 21.368C55.8496 21.0973 55.6816 20.8733 55.495 20.696C55.3176 20.5187 55.0983 20.388 54.837 20.304C54.5756 20.22 54.2443 20.178 53.843 20.178H52.485V24ZM52.485 15.53V19.324H55.453C56.1716 19.324 56.699 19.1747 57.035 18.876C57.3803 18.568 57.553 18.0827 57.553 17.42C57.553 16.776 57.3803 16.3 57.035 15.992C56.699 15.684 56.1716 15.53 55.453 15.53H52.485ZM60.7775 24H59.7695V14.62H60.7775V24ZM66.0835 24H60.1055V23.076H66.0835V24ZM65.8735 19.744H60.1055V18.82H65.8735V19.744ZM66.0835 15.53H60.1055V14.62H66.0835V15.53ZM71.705 24H70.375L66.693 14.62H67.813L71.033 22.88H71.103L74.295 14.62H75.387L71.705 24Z"
              fill="white"
            />
            <rect
              x={104}
              y={2}
              width={36}
              height={36}
              rx={18}
              fill="black"
              fillOpacity={0.2}
            />
            <path
              d="M123.162 24H122.168V16.538H120.32V15.782H120.642C121.081 15.782 121.431 15.6933 121.692 15.516C121.963 15.3387 122.182 15.04 122.35 14.62H123.162V24Z"
              fill="white"
            />
            <rect
              x={144}
              y={2}
              width={35}
              height={36}
              rx={17.5}
              fill="black"
              fillOpacity={0.87}
            />
            <path
              d="M164.837 24H158.299V23.356C158.299 22.7773 158.402 22.2873 158.607 21.886C158.822 21.4847 159.111 21.1393 159.475 20.85C159.849 20.5513 160.25 20.2807 160.679 20.038L162.149 19.226C162.523 19.0207 162.826 18.82 163.059 18.624C163.293 18.428 163.465 18.218 163.577 17.994C163.699 17.7607 163.759 17.4853 163.759 17.168C163.759 16.8227 163.699 16.5193 163.577 16.258C163.456 15.9873 163.241 15.7773 162.933 15.628C162.625 15.4787 162.177 15.404 161.589 15.404C160.945 15.404 160.446 15.488 160.091 15.656C159.746 15.8147 159.503 16.062 159.363 16.398C159.233 16.7247 159.167 17.14 159.167 17.644V17.812H158.159V17.588C158.159 17.0187 158.276 16.5007 158.509 16.034C158.752 15.558 159.13 15.18 159.643 14.9C160.166 14.62 160.833 14.48 161.645 14.48C162.373 14.48 162.966 14.6013 163.423 14.844C163.89 15.0773 164.231 15.3947 164.445 15.796C164.66 16.188 164.767 16.622 164.767 17.098C164.767 17.5833 164.665 18.008 164.459 18.372C164.263 18.7267 164.002 19.0347 163.675 19.296C163.349 19.548 162.985 19.7907 162.583 20.024L161.169 20.808C160.619 21.1067 160.171 21.424 159.825 21.76C159.489 22.096 159.326 22.5347 159.335 23.076H161.183H164.837V24Z"
              fill="white"
            />
            <rect
              x={183}
              y={2}
              width={36}
              height={36}
              rx={18}
              fill="black"
              fillOpacity={0.2}
            />
            <path
              d="M201.083 24.14C200.233 24.14 199.543 24.0093 199.011 23.748C198.488 23.4773 198.11 23.118 197.877 22.67C197.643 22.2127 197.527 21.6993 197.527 21.13V20.906H198.521V21.088C198.521 21.564 198.591 21.9607 198.731 22.278C198.88 22.5953 199.141 22.8287 199.515 22.978C199.888 23.1273 200.411 23.202 201.083 23.202C201.96 23.202 202.576 23.062 202.931 22.782C203.285 22.502 203.463 22.0353 203.463 21.382C203.463 20.7193 203.281 20.248 202.917 19.968C202.562 19.6787 201.997 19.534 201.223 19.534H199.543V18.68H201.013C201.778 18.68 202.329 18.554 202.665 18.302C203.01 18.05 203.183 17.6347 203.183 17.056C203.183 16.4867 203.019 16.0713 202.693 15.81C202.366 15.5393 201.801 15.404 200.999 15.404C200.364 15.404 199.865 15.4833 199.501 15.642C199.146 15.7913 198.894 16.0247 198.745 16.342C198.595 16.65 198.521 17.042 198.521 17.518V17.658H197.527V17.49C197.527 16.9207 197.653 16.412 197.905 15.964C198.157 15.5067 198.539 15.1473 199.053 14.886C199.575 14.6153 200.224 14.48 200.999 14.48C201.661 14.48 202.231 14.578 202.707 14.774C203.183 14.9607 203.547 15.236 203.799 15.6C204.06 15.9547 204.191 16.398 204.191 16.93C204.191 17.462 204.046 17.9193 203.757 18.302C203.467 18.6753 203.029 18.9133 202.441 19.016V19.072C203.094 19.1933 203.593 19.4593 203.939 19.87C204.293 20.2807 204.471 20.8173 204.471 21.48C204.471 22.0587 204.331 22.544 204.051 22.936C203.771 23.328 203.374 23.6267 202.861 23.832C202.357 24.0373 201.764 24.14 201.083 24.14Z"
              fill="white"
            />
            <rect
              x={223}
              y={2}
              width={36}
              height={36}
              rx={18}
              fill="black"
              fillOpacity={0.2}
            />
            <path
              d="M244.966 21.914H236.972V21.186L242.264 14.62H243.076L242.586 15.88H242.348L238.26 20.92V21.004H244.966V21.914ZM243.426 24H242.432V14.62H243.426V24Z"
              fill="white"
            />
            <rect
              x={263}
              y={2}
              width={36}
              height={36}
              rx={18}
              fill="black"
              fillOpacity={0.2}
            />
            <path
              d="M281.031 24.14C279.874 24.14 278.987 23.888 278.371 23.384C277.755 22.88 277.447 22.1987 277.447 21.34V21.256H278.455V21.34C278.455 21.7973 278.553 22.166 278.749 22.446C278.945 22.7167 279.234 22.9127 279.617 23.034C280.009 23.146 280.494 23.202 281.073 23.202C281.978 23.202 282.622 23.0433 283.005 22.726C283.388 22.4087 283.579 21.8487 283.579 21.046C283.579 20.2807 283.383 19.7393 282.991 19.422C282.599 19.0953 281.969 18.932 281.101 18.932C280.485 18.932 279.981 19.002 279.589 19.142C279.206 19.2727 278.861 19.4267 278.553 19.604L278.259 19.394L278.287 18.764L278.651 18.834C278.968 18.61 279.351 18.428 279.799 18.288C280.256 18.1387 280.779 18.064 281.367 18.064C282.002 18.064 282.562 18.1807 283.047 18.414C283.532 18.638 283.906 18.9693 284.167 19.408C284.438 19.8467 284.573 20.388 284.573 21.032C284.573 21.6667 284.438 22.2173 284.167 22.684C283.906 23.1507 283.514 23.51 282.991 23.762C282.478 24.014 281.824 24.14 281.031 24.14ZM278.931 15.53L278.553 19.604L277.685 19.422L278.049 14.62H284.069V15.53H278.931Z"
              fill="white"
            />
            <path
              d="M317.737 24H316.505V22.054H317.737V24ZM321.613 24H320.381V22.054H321.613V24ZM325.49 24H324.258V22.054H325.49V24Z"
              fill="white"
            />
            <rect
              x={343}
              y={2}
              width={36}
              height={36}
              rx={18}
              fill="black"
              fillOpacity={0.2}
            />
            <path
              d="M361.069 24.14C360.416 24.14 359.837 24.0233 359.333 23.79C358.839 23.5473 358.451 23.2067 358.171 22.768C357.901 22.3293 357.765 21.8113 357.765 21.214V21.13H358.815V21.214C358.815 21.5593 358.881 21.886 359.011 22.194C359.142 22.4927 359.375 22.7307 359.711 22.908C360.047 23.076 360.519 23.16 361.125 23.16C361.835 23.16 362.367 23.0293 362.721 22.768C363.085 22.4973 363.333 22.0913 363.463 21.55C363.594 21.0087 363.659 20.3227 363.659 19.492V18.708H363.589C363.468 19.0253 363.277 19.3147 363.015 19.576C362.763 19.828 362.437 20.0333 362.035 20.192C361.634 20.3507 361.153 20.43 360.593 20.43C359.903 20.43 359.315 20.3087 358.829 20.066C358.353 19.814 357.989 19.4687 357.737 19.03C357.495 18.5913 357.373 18.078 357.373 17.49C357.373 16.5753 357.677 15.8473 358.283 15.306C358.899 14.7553 359.772 14.48 360.901 14.48C361.816 14.48 362.549 14.6527 363.099 14.998C363.659 15.334 364.061 15.8567 364.303 16.566C364.555 17.2753 364.681 18.19 364.681 19.31C364.681 20.0193 364.616 20.668 364.485 21.256C364.364 21.844 364.163 22.3573 363.883 22.796C363.613 23.2253 363.244 23.5567 362.777 23.79C362.311 24.0233 361.741 24.14 361.069 24.14ZM360.873 19.562C361.461 19.562 361.947 19.4827 362.329 19.324C362.712 19.1653 362.992 18.932 363.169 18.624C363.347 18.316 363.435 17.938 363.435 17.49C363.435 17.042 363.342 16.664 363.155 16.356C362.978 16.048 362.698 15.8193 362.315 15.67C361.942 15.5207 361.461 15.446 360.873 15.446C360.267 15.446 359.777 15.5207 359.403 15.67C359.039 15.8193 358.773 16.048 358.605 16.356C358.447 16.664 358.367 17.0513 358.367 17.518C358.367 17.966 358.447 18.344 358.605 18.652C358.764 18.9507 359.03 19.1793 359.403 19.338C359.777 19.4873 360.267 19.562 360.873 19.562Z"
              fill="white"
            />
            <rect
              x={383}
              y={2}
              width={36}
              height={36}
              rx={18}
              fill="black"
              fillOpacity={0.2}
            />
            <path
              d="M397.448 24H396.454V16.538H394.606V15.782H394.928C395.367 15.782 395.717 15.6933 395.978 15.516C396.249 15.3387 396.468 15.04 396.636 14.62H397.448V24ZM403.202 24.14C402.418 24.14 401.736 23.9487 401.158 23.566C400.579 23.1833 400.126 22.6327 399.8 21.914C399.482 21.186 399.324 20.318 399.324 19.31C399.324 18.302 399.482 17.4387 399.8 16.72C400.126 15.992 400.579 15.4367 401.158 15.054C401.736 14.6713 402.418 14.48 403.202 14.48C403.986 14.48 404.667 14.6713 405.246 15.054C405.824 15.4367 406.272 15.992 406.59 16.72C406.916 17.4387 407.08 18.302 407.08 19.31C407.08 20.318 406.916 21.186 406.59 21.914C406.272 22.6327 405.824 23.1833 405.246 23.566C404.667 23.9487 403.986 24.14 403.202 24.14ZM403.202 23.174C403.818 23.174 404.336 23.0387 404.756 22.768C405.185 22.4973 405.502 22.0773 405.708 21.508C405.922 20.9387 406.03 20.206 406.03 19.31C406.03 18.414 405.922 17.6813 405.708 17.112C405.502 16.5333 405.185 16.1087 404.756 15.838C404.336 15.5673 403.818 15.432 403.202 15.432C402.595 15.432 402.082 15.5673 401.662 15.838C401.242 16.1087 400.924 16.5333 400.71 17.112C400.495 17.6813 400.388 18.414 400.388 19.31C400.388 20.206 400.495 20.9387 400.71 21.508C400.924 22.0773 401.242 22.4973 401.662 22.768C402.082 23.0387 402.595 23.174 403.202 23.174Z"
              fill="white"
            />
            <rect
              x={431}
              width={93}
              height={40}
              rx={20}
              fill="black"
              fillOpacity={0.38}
            />
            <path
              d="M449.118 24H448.11V14.62H449.188L453.416 20.864L454.396 22.334H454.494V20.864V14.62H455.488V24H454.396L450.154 17.756L449.174 16.314H449.118V17.756V24ZM458.299 24H457.291V14.62H458.299V24ZM463.605 24H457.627V23.076H463.605V24ZM463.395 19.744H457.627V18.82H463.395V19.744ZM463.605 15.53H457.627V14.62H463.605V15.53ZM465.798 24H464.594L468.01 19.296V19.198L464.594 14.62H465.812L468.766 18.568H468.85L471.79 14.62H473.008L469.578 19.198V19.282L473.008 24H471.776L468.822 19.912H468.766L465.798 24ZM478.268 24H477.274V14.62H478.268V24ZM481.586 15.53H473.942V14.62H481.586V15.53Z"
              fill="white"
            />
            <path
              d="M497.5 25L502.5 20L497.5 15"
              stroke="white"
              strokeWidth={1.5}
              strokeLinecap="round"
              strokeLinejoin="round"
            />
          </svg>
        </div>
      </div>
    </div>
  );
};

export default Main;
